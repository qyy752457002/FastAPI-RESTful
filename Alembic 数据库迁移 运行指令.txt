https://fastapi.blog/blog/posts/2023-07-20-fastapi-sqlalchemy-migrations-guide/#conclusion


以下是在FastAPI项目中使用Alembic进行数据库迁移的主要命令总结:

1. 初始化Alembic:

alembic init alembic

这会创建alembic目录和必要的配置文件。

-----------------------------------------------------------------------------------------------

2. 生成迁移脚本:

alembic revision --autogenerate -m "描述性消息"

自动检测模型变化并生成迁移脚本。

-----------------------------------------------------------------------------------------------

3. 应用迁移:

alembic upgrade head

将数据库更新到最新版本。

-----------------------------------------------------------------------------------------------

4. 查看当前版本:

alembic current

-----------------------------------------------------------------------------------------------

5. 查看迁移历史:

alembic history

-----------------------------------------------------------------------------------------------

6. 回滚到特定版本:

alembic downgrade <版本号>

ex. alembic downgrade fb617897c1bb

-----------------------------------------------------------------------------------------------

7. 生成空的迁移脚本:

alembic revision -m "描述性消息"

-----------------------------------------------------------------------------------------------

8. 应用下一个迁移:

alembic upgrade +1

将数据库更新到下一个版本。

-----------------------------------------------------------------------------------------------

9. 回滚一个版本:

alembic downgrade -1

将数据库回滚到上一个版本。

-----------------------------------------------------------------------------------------------

10. 清理未使用的迁移文件:

alembic prune

删除未使用的迁移文件。

-----------------------------------------------------------------------------------------------

这些命令可以帮助你在FastAPI项目中使用Alembic进行数据库迁移。

